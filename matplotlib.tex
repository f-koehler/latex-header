% makes writing commands much easier
\usepackage{xparse}

% lua base packages
\usepackage{luacode}
\usepackage{luatexbase}
\usepackage{lualatex-math}

% typography
\usepackage{polyglossia}
\setdefaultlanguage[spelling=new, babelshorthands=true]{german}

% bibliography
\usepackage[backend=biber,language=auto,bibencoding=utf8]{biblatex}
\usepackage[strict,autostyle]{csquotes}

% fonts
\usepackage{fontspec}

% graphics
\usepackage{graphicx}

% drawing
\usepackage{tikz}

% tables
\usepackage{booktabs}

% links
\usepackage{hyperref}
\usepackage{url}

% captions
\usepackage{subcaption}

% FloatBarrier
\usepackage[section]{placeins}
\RequireLuaModule{lualibs}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}

% mathup
\usepackage[partial=upright]{unicode-math}

% tensors (e.g. lorentz indices)
\usepackage{tensor}

% dirac notation
\usepackage{braket}
\ExplSyntaxOn{}

\DeclareDocumentCommand\numberthis{}{\addtocounter{equation}{1}\tag{\theequation}}

\DeclareDocumentCommand\const{}{\mathup{const}}
\DeclareDocumentCommand\inv{m}{{#1}^{-1}}
\DeclareDocumentCommand\ev{m}{{\langle{#1}\rangle}}

\ExplSyntaxOff{}
\ExplSyntaxOn{}

% unicode-math would otherwise reset these
\AtBeginDocument{%
  \DeclareDocumentCommand\Re{}{\operatorname{Re}}
  \DeclareDocumentCommand\Im{}{\operatorname{Im}}
}

\ExplSyntaxOff{}
\ExplSyntaxOn{}

\DeclareDocumentCommand\diff{o}{%
  \IfNoValueTF{#1}{%
    \mathup{d}
  }{%
    \mathup{d}^#1
  }
}

\ExplSyntaxOff{}
\ExplSyntaxOn{}

\DeclareDocumentCommand\id{}{\operatorname{id}}
\DeclareDocumentCommand\exp{}{\operatorname{exp}}
\DeclareDocumentCommand\log{}{\operatorname{log}}
\DeclareDocumentCommand\ln{}{\operatorname{ln}}
\DeclareDocumentCommand\lg{}{\operatorname{lg}}
\DeclareDocumentCommand\max{}{\operatorname*{max}}
\DeclareDocumentCommand\min{}{\operatorname*{min}}
\DeclareDocumentCommand\dim{}{\operatorname{dim}}
\DeclareDocumentCommand\sup{}{\operatorname{sup}}
\DeclareDocumentCommand\inf{}{\operatorname{inf}}

\ExplSyntaxOff{}
\ExplSyntaxOn{}

\DeclareDocumentCommand\GammaF{}{\mathup{\Gamma}}
\DeclareDocumentCommand\BesselJ{m}{\mathup{J}_{#1}}
\DeclareDocumentCommand\SpherHarm{}{\mathup{Y}}
\DeclareDocumentCommand\RiemannZ{}{\mathup{\zeta}}

\ExplSyntaxOff{}
\ExplSyntaxOn{}

\DeclareDocumentCommand\cos{}{\operatorname{cos}}
\DeclareDocumentCommand\sin{}{\operatorname{sin}}
\DeclareDocumentCommand\tan{}{\operatorname{tan}}
\DeclareDocumentCommand\cot{}{\operatorname{cot}}
\DeclareDocumentCommand\csc{}{\operatorname{csc}}
\DeclareDocumentCommand\sec{}{\operatorname{sec}}
\DeclareDocumentCommand\cosh{}{\operatorname{cosh}}
\DeclareDocumentCommand\sinh{}{\operatorname{sinh}}
\DeclareDocumentCommand\tanh{}{\operatorname{tanh}}
\DeclareDocumentCommand\coth{}{\operatorname{coth}}
\DeclareDocumentCommand\csch{}{\operatorname{csch}}
\DeclareDocumentCommand\sech{}{\operatorname{sech}}
\DeclareDocumentCommand\arccos{}{\operatorname{arccos}}
\DeclareDocumentCommand\arcsin{}{\operatorname{arcsin}}
\DeclareDocumentCommand\arctan{}{\operatorname{arctan}}
\DeclareDocumentCommand\arccot{}{\operatorname{arccot}}
\DeclareDocumentCommand\arccsc{}{\operatorname{arccsc}}
\DeclareDocumentCommand\arcsec{}{\operatorname{arcsec}}
\DeclareDocumentCommand\arcosh{}{\operatorname{arcosh}}
\DeclareDocumentCommand\arsinh{}{\operatorname{arsinh}}
\DeclareDocumentCommand\artanh{}{\operatorname{artanh}}
\DeclareDocumentCommand\arcoth{}{\operatorname{arcoth}}
\DeclareDocumentCommand\arcsch{}{\operatorname{arcsch}}
\DeclareDocumentCommand\arsech{}{\operatorname{arsech}}
\DeclareDocumentCommand\sinc{}{\operatorname{sinc}}

\ExplSyntaxOff{}
\ExplSyntaxOn{}
 
\DeclareDocumentCommand\m{}{\mathbf}
\DeclareDocumentCommand\mzero{}{\mathbb{0}}
\DeclareDocumentCommand\mone{}{\mathbb{1}}
\DeclareDocumentCommand\mtrans{m}{\m{#1}^{\top}}
\DeclareDocumentCommand\mdagger{m}{\m{#1}^{\dagger}}
\DeclareDocumentCommand\mconj{m}{\m{#1}^{*}}
\DeclareDocumentCommand\Tr{}{\operatorname{Tr}}
\DeclareDocumentCommand\det{}{\operatorname{det}}
\DeclareDocumentCommand\diag{}{\operatorname{diag}}
\DeclareDocumentCommand\ker{}{\operatorname{ker}}

% gamma matrices
\DeclareDocumentCommand\mgamma{}{\mathup{\gamma}}
\DeclareDocumentCommand\GammaT{}{\begin{pmatrix}1&0&0&0\\0&1&0&0\\0&0&-1&0\\0&0&0&-1\end{pmatrix}}
\DeclareDocumentCommand\GammaX{}{\begin{pmatrix}0&0&0&1\\0&0&1&0\\0&-1&0&0\\-1&0&0&0\end{pmatrix}}
\DeclareDocumentCommand\GammaY{}{\begin{pmatrix}0&0&0&-i\\0&0&i&0\\0&i&0&0\\-i&0&0&0\end{pmatrix}}
\DeclareDocumentCommand\GammaZ{}{\begin{pmatrix}0&0&1&0\\0&0&0&-1\\-1&0&0&0\\0&1&0&0\end{pmatrix}}

% pauli matrices
\DeclareDocumentCommand\mpauli{}{\mathup{\sigma}}
\DeclareDocumentCommand\PauliX{}{\begin{pmatrix}0&1\\1&0\end{pmatrix}}
\DeclareDocumentCommand\PauliY{}{\begin{pmatrix}0&-i\\i&0\end{pmatrix}}
\DeclareDocumentCommand\PauliZ{}{\begin{pmatrix}1&0\\-1&0\end{pmatrix}}

\ExplSyntaxOff{}
\ExplSyntaxOn{}

\DeclareDocumentCommand\v{}{\mathbf}
\DeclareDocumentCommand\uv{m}{\mathbf{\hat{#1}}}

\ExplSyntaxOff{}
% drawing circuits with tikz
\usepackage[europeanresistors,americaninductors]{circuitikz}

% proper units
\usepackage{siunitx}

% isotopes
\usepackage{isotope}
\ExplSyntaxOn{}

\DeclareDocumentCommand\up{\uparrow}
\DeclareDocumentCommand\down{\downarrow}

\ExplSyntaxOff{}
\sisetup{exponent-product=\cdot, output-product=\cdot}
\sisetup{separate-uncertainty}
\sisetup{range-phrase=%
  \ifmmode\mathbin{-}
  \else
  \thinspace\textendash\thinspace{}
  \fi%
}
\sisetup{detect-all}
